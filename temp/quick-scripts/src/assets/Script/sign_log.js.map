{"version":3,"sources":["assets\\Script\\sign_log.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\ndeclare const firebase: any;\r\n@ccclass\r\nexport default class sign_log extends cc.Component {\r\n    @property(cc.Prefab)\r\n    sign_block:cc.Prefab=null;\r\n    @property(cc.Prefab)\r\n    log_block:cc.Prefab=null;\r\n    @property({type:cc.AudioClip})\r\n    bgm: cc.AudioClip = null;\r\n    public path:string=\"\";\r\n    private email:cc.EditBox=null;\r\n    private password:cc.EditBox=null;\r\n    private user_name:cc.EditBox=null;\r\n    private log_sign:number=0;\r\n    start () {\r\n        cc.audioEngine.playMusic(this.bgm,true);\r\n        var log_btn= new cc.Component.EventHandler();\r\n        log_btn.target= this.node;\r\n        log_btn.component='sign_log';\r\n        log_btn.handler='open_log_block';\r\n        cc.find('Canvas/background/log').getComponent(cc.Button).clickEvents.push(log_btn);\r\n        \r\n        var sign_btn= new cc.Component.EventHandler();\r\n        sign_btn.target= this.node;\r\n        sign_btn.component='sign_log';\r\n        sign_btn.handler='open_sign_block';\r\n        cc.find('Canvas/background/sign').getComponent(cc.Button).clickEvents.push(sign_btn);\r\n        \r\n    }\r\n    open_log_block(){\r\n        if(this.log_sign==1)this.close_sign_block();\r\n        if(this.log_sign==0){\r\n            var block=cc.instantiate(this.log_block);\r\n            block.setPosition(0, 0);\r\n            cc.find('Canvas/background').addChild(block);\r\n            var close_btn2= new cc.Component.EventHandler();\r\n            close_btn2.target=this.node;\r\n            close_btn2.component='sign_log';\r\n            close_btn2.handler='close_log_block';\r\n            cc.find('Canvas/background/log_block/close').getComponent(cc.Button).clickEvents.push(close_btn2);\r\n            var enter_btn= new cc.Component.EventHandler();\r\n            enter_btn.target=this.node;\r\n            enter_btn.component='sign_log';\r\n            enter_btn.handler='click_log';\r\n            cc.find('Canvas/background/log_block/Enter').getComponent(cc.Button).clickEvents.push(enter_btn);\r\n        }\r\n        this.log_sign=2;\r\n    }\r\n    close_log_block(){\r\n        cc.find('Canvas/background/log_block').destroy();\r\n        if(this.log_sign==2)this.log_sign=0;\r\n    }\r\n    click_log=()=>{\r\n        this.email=cc.find('Canvas/background/log_block/Email').getComponent(cc.EditBox);\r\n        this.password=cc.find('Canvas/background/log_block/Password').getComponent(cc.EditBox);\r\n        firebase.auth().signInWithEmailAndPassword(this.email.string,this.password.string).then((result)=>{\r\n            var tmp=this.email.string.split('@');\r\n            var user=tmp[0];\r\n            var ref=firebase.database().ref('prevent/'+user+'/life');\r\n            ref.once('value').then((snapshot)=>{\r\n                ref.set(snapshot.val()+1);\r\n            });\r\n            cc.director.loadScene('menu');\r\n            //this.handleChangeuser(user);\r\n            //this.handleChangemode();\r\n        }).catch((error)=>{\r\n            console.log(error.message);\r\n            //this.create_alert('error',error.message);\r\n        });\r\n    }\r\n\r\n    open_sign_block(){\r\n        if(this.log_sign==2)this.close_log_block();\r\n        if(this.log_sign==0){\r\n            var block=cc.instantiate(this.sign_block);\r\n            block.setPosition(0, 0);\r\n            cc.find('Canvas/background').addChild(block);\r\n            var close_btn1= new cc.Component.EventHandler();\r\n            close_btn1.target=this.node;\r\n            close_btn1.component='sign_log';\r\n            close_btn1.handler='close_sign_block';\r\n            cc.find('Canvas/background/sign_block/close').getComponent(cc.Button).clickEvents.push(close_btn1);\r\n            var enter_btn= new cc.Component.EventHandler();\r\n            enter_btn.target=this.node;\r\n            enter_btn.component='sign_log';\r\n            enter_btn.handler='click_sign';\r\n            cc.find('Canvas/background/sign_block/Enter').getComponent(cc.Button).clickEvents.push(enter_btn);\r\n        }    \r\n        this.log_sign=1;\r\n    }\r\n    close_sign_block(){\r\n        cc.find('Canvas/background/sign_block').destroy();\r\n        if(this.log_sign==1)this.log_sign=0;\r\n    }\r\n    click_sign=()=>{\r\n        this.email=cc.find('Canvas/background/sign_block/Email').getComponent(cc.EditBox);\r\n        this.password=cc.find('Canvas/background/sign_block/Password').getComponent(cc.EditBox);\r\n        this.user_name=cc.find('Canvas/background/sign_block/UserName').getComponent(cc.EditBox);\r\n        firebase.auth().createUserWithEmailAndPassword(this.email.string,this.password.string).then((result)=>{\r\n            //this.create_alert('success','sign up successfully');\r\n            var user=this.user_name.string;\r\n            user=user.toUpperCase();\r\n            var tmp=this.email.string.split('@');\r\n            this.path=tmp[0];\r\n            console.log(this.path);\r\n            var ref_user_list=firebase.database().ref('/prevent/'+this.path);\r\n            ref_user_list.set({\r\n                user:user,\r\n                life:5,\r\n                score:0,\r\n                coin:0,\r\n                stage1:false,\r\n                stage2:false,\r\n                now:0\r\n            });//需要修正\r\n            console.log('success');\r\n        }).catch((error)=>{\r\n            //this.create_alert('error',error.message);\r\n            console.log(error.message);\r\n        });\r\n    }\r\n    // update (dt) {}\r\n}\r\n"]}